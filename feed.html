<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Artisyn • Feed</title>
  <link rel="icon" type="image/png" href="Favicon.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
  <style>
    .feed { max-width: 1024px; margin: 0 auto; padding: 24px 16px 64px; }
    .tabs { display:flex; gap:8px; margin-bottom:12px; }
    .tab { padding: 6px 12px; border-radius:9999px; cursor:pointer; background:#0ea5e9; color:#fff; font-weight:700; }
    .tab.secondary { background:#e2e8f0; color:#0f172a; }
    .post { background:#0b1225; border:1px solid #1f2937; border-radius:12px; overflow:hidden; color:#e2e8f0; }
    .post img { width:100%; height:220px; object-fit:cover; }
    .badge { background:#16a34a; color:#dcfce7; font-weight:700; font-size:0.7rem; padding:2px 8px; border-radius:9999px; }
    .follow { background:#e2e8f0; color:#0f172a; border:none; border-radius:9999px; padding:6px 12px; font-weight:700; cursor:pointer; }
  </style>
</head>
<body>
  <header class="py-6 px-8 flex items-center justify-between max-w-screen-xl mx-auto">
    <div class="flex items-center gap-3">
      <span class="text-white font-bold text-xl">Artisyn</span>
    </div>
    <nav class="flex gap-4 text-white opacity-90">
      <a href="index.html">Home</a>
      <a href="ai-enhancer.html">AI Enhancer</a>
      <a href="forum.html">Forum</a>
      <a href="challenges.html">Challenges</a>
      <a href="stories.html">Stories</a>
      <a href="partners.html">Partners</a>
    </nav>
  </header>
  <main class="feed">
    <h1 class="text-white text-3xl font-extrabold mb-3">Feed</h1>
    <div class="tabs">
      <button id="tabFollowing" class="tab">Following</button>
      <button id="tabGlobal" class="tab secondary">Global</button>
    </div>
    <div id="posts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
  </main>

  <script src="data.js"></script>
  <script src="app.js"></script>
  <script>
    const postsEl = document.getElementById('posts');
    const tabFollowing = document.getElementById('tabFollowing');
    const tabGlobal = document.getElementById('tabGlobal');
    let mode = 'following';

    function render(){
      const follows = APP.getFollows();
      const list = DATA.posts
        .filter(p => mode==='global' ? true : follows.has(p.artisanId))
        .sort((a,b)=> Number(b.sustainable)-Number(a.sustainable) || b.likes-a.likes);

      postsEl.innerHTML = list.map(p=>{
        const artisan = APP.byId(DATA.artisans, p.artisanId) || { name:'Unknown', sustainable:false };
        const isFollow = APP.isFollowing(artisan.id);
        return `
          <article class="post">
            <img src="${p.image}" alt="${p.title}" />
            <div class="p-3 flex items-start justify-between gap-3">
              <div>
                <div class="font-bold">${p.title}</div>
                <div class="text-sm text-slate-300">by ${artisan.name}</div>
                ${p.sustainable ? '<span class="badge mt-1 inline-block">Sustainable</span>' : ''}
              </div>
              <button class="follow" data-artisan="${artisan.id}">${isFollow ? 'Unfollow' : 'Follow'}</button>
            </div>
          </article>`;
      }).join('');

      postsEl.querySelectorAll('.follow').forEach(btn=>{
        btn.addEventListener('click', ()=>{ APP.toggleFollow(btn.dataset.artisan); render(); });
      });

      tabFollowing.classList.toggle('secondary', mode!=='following');
      tabGlobal.classList.toggle('secondary', mode!=='global');
    }

    tabFollowing.addEventListener('click', ()=>{ mode='following'; render(); });
    tabGlobal.addEventListener('click', ()=>{ mode='global'; render(); });
    render();
  </script>
  <footer class="site-footer">
    <div class="inner">
      <div>© <span id="year"></span> Artisyn — Empowering local artisans.</div>
      <div class="flex gap-4">
        <a href="index.html">Home</a>
        <a href="ai-enhancer.html">AI Enhancer</a>
        <a href="forum.html">Forum</a>
        <a href="challenges.html">Challenges</a>
        <a href="stories.html">Stories</a>
        <a href="partners.html">Partners</a>
      </div>
    </div>
  </footer>
  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
</body>
</html>
